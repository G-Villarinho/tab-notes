.PHONY: run
run:
	@go run main.go

.PHONY: setup
setup:
	@echo "ğŸ“¦ Instalando ferramentas e preparando ambiente..."

	@if ! command -v mockery &> /dev/null; then \
		echo "ğŸ”§ Instalando mockery..."; \
		go install github.com/vektra/mockery/v2@v2.53.3; \
	else \
		echo "âœ… mockery jÃ¡ estÃ¡ instalado."; \
	fi

.PHONY: generate-key
generate-key: 
	@echo "ğŸ”‘ Gerando chaves ECDSA..."
	@openssl ecparam -name prime256v1 -genkey -noout -out ecdsa_private.pem
	@openssl ec -in ecdsa_private.pem -pubout -out ecdsa_public.pem

.PHONY: docker-up
docker-up: 
	@echo "ğŸš€ Iniciando containers..."
	@sudo docker-compose up -d

.PHONY: docker-down
docker-down: 
	@echo "ğŸ›‘ Parando containers..."
	@docker-compose down

.PHONY: mock
mock: 
	@echo "ğŸ”„ Gerando mocks..."
	@mockery

kill-port:
	@echo "ğŸ”« Matando processo na porta 8080..."
	@fuser -k 8080/tcp || true